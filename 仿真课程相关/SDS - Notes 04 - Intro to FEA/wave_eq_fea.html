<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
		"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<title>wave_eq_fea.py</title>
</head>
<body style="color: rgb(23, 23, 23); background-color: rgb(247, 245, 235)">
<pre><code>
<span style="color: rgb(52, 60, 247);">import</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">getopt</span><span style="color: rgb(23, 23, 23);">
</span><span style="color: rgb(52, 60, 247);">import</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">importlib</span><span style="color: rgb(23, 23, 23);">
</span><span style="color: rgb(52, 60, 247);">import</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">os</span><span style="color: rgb(23, 23, 23);">
</span><span style="color: rgb(52, 60, 247);">import</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">re</span><span style="color: rgb(23, 23, 23);">
</span><span style="color: rgb(52, 60, 247);">import</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">sys</span><span style="color: rgb(23, 23, 23);">
</span><span style="color: rgb(52, 60, 247);">import</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">traceback</span><span style="color: rgb(23, 23, 23);">

</span><span style="color: rgb(52, 60, 247);">import</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">numpy</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">as</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">
</span><span style="color: rgb(158, 0, 0);">#&nbsp;import&nbsp;scipy&nbsp;as&nbsp;sp</span><span style="color: rgb(23, 23, 23);">
</span><span style="color: rgb(52, 60, 247);">import</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">scipy</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">linalg</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">as</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">la</span><span style="color: rgb(23, 23, 23);">
</span><span style="color: rgb(52, 60, 247);">import</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">scipy</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">integrate</span><span style="color: rgb(23, 23, 23);">
</span><span style="color: rgb(52, 60, 247);">import</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">h5py</span><span style="color: rgb(23, 23, 23);">

</span><span style="color: rgb(52, 60, 247);">import</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">matplotlib</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">pyplot</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">as</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">
</span><span style="color: rgb(52, 60, 247);">from</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">mpl_toolkits</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">mplot3d</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">import</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">Axes3D</span><span style="color: rgb(23, 23, 23);">


</span><span style="color: rgb(52, 60, 247);">class</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">DOF</span><span style="color: rgb(23, 23, 23);">:

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;global&nbsp;degree&nbsp;of&nbsp;freedom.

&nbsp;&nbsp;&nbsp;&nbsp;Each&nbsp;degree&nbsp;of&nbsp;freedom&nbsp;is&nbsp;identified&nbsp;by&nbsp;an&nbsp;arbitrary&nbsp;number,&nbsp;which
&nbsp;&nbsp;&nbsp;&nbsp;may&nbsp;be&nbsp;used&nbsp;to&nbsp;enumerate&nbsp;the&nbsp;scalar&nbsp;FE&nbsp;equations.

&nbsp;&nbsp;&nbsp;&nbsp;Geometric&nbsp;boundary&nbsp;conditions,&nbsp;including&nbsp;prescribed&nbsp;displacements,
&nbsp;&nbsp;&nbsp;&nbsp;may&nbsp;be&nbsp;imposed&nbsp;at&nbsp;each&nbsp;DOF.
&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(50, 105, 186);">__init__</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(50, 105, 186);">number</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">bc</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Create&nbsp;an&nbsp;object&nbsp;representing&nbsp;a&nbsp;global&nbsp;degree&nbsp;of&nbsp;freedom.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;&nbsp;Integer&nbsp;identifying&nbsp;the&nbsp;DOF&nbsp;(i.e.,&nbsp;equation&nbsp;number)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Geometric&nbsp;boundary&nbsp;condtion.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bc&nbsp;may&nbsp;be&nbsp;any&nbsp;of&nbsp;None,&nbsp;meaning&nbsp;the&nbsp;degree&nbsp;of&nbsp;freedom
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;unconstrained;&nbsp;a&nbsp;scalar&nbsp;(e.g.,&nbsp;0.0),&nbsp;which&nbsp;will&nbsp;be
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;imposed&nbsp;at&nbsp;all&nbsp;times;&nbsp;or&nbsp;a&nbsp;function&nbsp;of&nbsp;time&nbsp;(e.g.,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;harmonic&nbsp;motion).

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;bc&nbsp;is&nbsp;provided&nbsp;as&nbsp;a&nbsp;function,&nbsp;it&nbsp;should&nbsp;take&nbsp;one&nbsp;argument,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;scalar&nbsp;or&nbsp;1-D&nbsp;array&nbsp;t&nbsp;of&nbsp;time&nbsp;values,&nbsp;and&nbsp;return
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;displacment,&nbsp;velocity,&nbsp;and&nbsp;acceleration&nbsp;values&nbsp;of&nbsp;the&nbsp;same
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shape&nbsp;as&nbsp;t.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">number</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">number</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">bc</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">bc</span><span style="color: rgb(23, 23, 23);">


</span><span style="color: rgb(52, 60, 247);">class</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(50, 105, 186);">Node</span><span style="color: rgb(23, 23, 23);">:

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;node&nbsp;in&nbsp;the&nbsp;finite&nbsp;element&nbsp;mesh.

&nbsp;&nbsp;&nbsp;&nbsp;Each&nbsp;node&nbsp;has&nbsp;an&nbsp;arbitrary&nbsp;identifying&nbsp;number,&nbsp;a&nbsp;unique&nbsp;location,
&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;a&nbsp;global&nbsp;degree&nbsp;of&nbsp;freedom.
&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(50, 105, 186);">__init__</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(50, 105, 186);">number</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Create&nbsp;an&nbsp;object&nbsp;representing&nbsp;a&nbsp;node.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;&nbsp;Integer&nbsp;identifying&nbsp;the&nbsp;node
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Global&nbsp;coordinate
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dof&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOF&nbsp;object&nbsp;to&nbsp;be&nbsp;associated&nbsp;with&nbsp;this&nbsp;node
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">number</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">number</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">


</span><span style="color: rgb(52, 60, 247);">class</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(50, 105, 186);">Element</span><span style="color: rgb(23, 23, 23);">:

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;finite&nbsp;element&nbsp;representing&nbsp;a&nbsp;portion&nbsp;of&nbsp;the&nbsp;domain.
&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(50, 105, 186);">__init__</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(50, 105, 186);">number</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">nodes</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Create&nbsp;an&nbsp;object&nbsp;representing&nbsp;an&nbsp;element.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;&nbsp;Integer&nbsp;identifying&nbsp;the&nbsp;element
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nodes&nbsp;&nbsp;&nbsp;List&nbsp;of&nbsp;2&nbsp;Nodes&nbsp;defining&nbsp;the&nbsp;element

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;DOF&nbsp;of&nbsp;the&nbsp;nodes&nbsp;will&nbsp;be&nbsp;accessible&nbsp;through&nbsp;this
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object's&nbsp;dof&nbsp;attribute.&nbsp;&nbsp;NB:&nbsp;These&nbsp;are&nbsp;not&nbsp;simply&nbsp;numbers.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">number</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">number</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">nodes</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">nodes</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;[</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">nodes</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">].</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">nodes</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">].</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">length</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">nodes</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">].</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">&nbsp;-&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">nodes</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">].</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">mass_matrix</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;the&nbsp;mass&nbsp;matrix&nbsp;of&nbsp;this&nbsp;element.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;&nbsp;Element&nbsp;mass&nbsp;matrix&nbsp;(2&nbsp;x&nbsp;2&nbsp;NumPy&nbsp;array)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">m</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">length</span><span style="color: rgb(23, 23, 23);">&nbsp;/&nbsp;</span><span style="color: rgb(186, 103, 6);">6.0</span><span style="color: rgb(23, 23, 23);">)&nbsp;*&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">array</span><span style="color: rgb(23, 23, 23);">([[</span><span style="color: rgb(186, 103, 6);">2.0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">1.0</span><span style="color: rgb(23, 23, 23);">],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[</span><span style="color: rgb(186, 103, 6);">1.0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">2.0</span><span style="color: rgb(23, 23, 23);">]])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">return</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">m</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">damping_matrix</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">lam</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;the&nbsp;damping&nbsp;matrix&nbsp;of&nbsp;this&nbsp;element.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Argument
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lam&nbsp;&nbsp;Distributed&nbsp;damping&nbsp;coefficient&nbsp;(scalar)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;&nbsp;Element&nbsp;damping&nbsp;matrix&nbsp;(2&nbsp;x&nbsp;2&nbsp;NumPy&nbsp;array)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">c</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">lam</span><span style="color: rgb(23, 23, 23);">&nbsp;*&nbsp;(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">length</span><span style="color: rgb(23, 23, 23);">&nbsp;/&nbsp;</span><span style="color: rgb(186, 103, 6);">6.0</span><span style="color: rgb(23, 23, 23);">)&nbsp;*&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">array</span><span style="color: rgb(23, 23, 23);">([[</span><span style="color: rgb(186, 103, 6);">2.0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">1.0</span><span style="color: rgb(23, 23, 23);">],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[</span><span style="color: rgb(186, 103, 6);">1.0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">2.0</span><span style="color: rgb(23, 23, 23);">]])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">return</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">c</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">stiffness_matrix</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;the&nbsp;linear&nbsp;stiffness&nbsp;matrix&nbsp;of&nbsp;this&nbsp;element.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;&nbsp;Element&nbsp;stiffness&nbsp;matrix&nbsp;(2&nbsp;x&nbsp;2&nbsp;NumPy&nbsp;array)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">k</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">array</span><span style="color: rgb(23, 23, 23);">([[&nbsp;</span><span style="color: rgb(186, 103, 6);">1.0</span><span style="color: rgb(23, 23, 23);">,&nbsp;-</span><span style="color: rgb(186, 103, 6);">1.0</span><span style="color: rgb(23, 23, 23);">],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[-</span><span style="color: rgb(186, 103, 6);">1.0</span><span style="color: rgb(23, 23, 23);">,&nbsp;&nbsp;</span><span style="color: rgb(186, 103, 6);">1.0</span><span style="color: rgb(23, 23, 23);">]])&nbsp;/&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">length</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">return</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">k</span><span style="color: rgb(23, 23, 23);">


</span><span style="color: rgb(52, 60, 247);">class</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">Problem</span><span style="color: rgb(23, 23, 23);">:

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;Collection&nbsp;of&nbsp;functions&nbsp;defining&nbsp;an&nbsp;FEA&nbsp;run.
&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(50, 105, 186);">__init__</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">linear</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">ke0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">pe0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">lam</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">t_max</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">dt</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">bcs</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">ic_shapes</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">ic_modes</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arguments
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linear&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Problem&nbsp;type&nbsp;(Boolean)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ke0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Desired&nbsp;initial&nbsp;kinetic&nbsp;energy&nbsp;(scalar)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pe0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Desired&nbsp;initial&nbsp;potential&nbsp;energy&nbsp;(scalar)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lam&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Distributed&nbsp;damping&nbsp;coefficient&nbsp;(scalar)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t_max&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Duration&nbsp;of&nbsp;analysis&nbsp;(scalar)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time&nbsp;step&nbsp;(scalar)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coordinates&nbsp;of&nbsp;nodes&nbsp;(1-D&nbsp;NumPy&nbsp;array)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bcs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Left&nbsp;and&nbsp;right-end&nbsp;BCs&nbsp;(list&nbsp;of&nbsp;2&nbsp;scalars&nbsp;or&nbsp;fns&nbsp;of&nbsp;t)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ic_shapes&nbsp;&nbsp;Initial&nbsp;displacement&nbsp;and&nbsp;velocity&nbsp;distributions
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(list&nbsp;of&nbsp;two&nbsp;1-D&nbsp;NumPy&nbsp;arrays)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ic_modes&nbsp;&nbsp;&nbsp;Modes&nbsp;used&nbsp;to&nbsp;represent&nbsp;ICs&nbsp;(list&nbsp;of&nbsp;ints);&nbsp;if&nbsp;empty,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no&nbsp;modal&nbsp;projection&nbsp;is&nbsp;done

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BCs&nbsp;can&nbsp;be&nbsp;specified&nbsp;as&nbsp;either&nbsp;displaements&nbsp;(scalars)&nbsp;or
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;functions&nbsp;of&nbsp;time&nbsp;(a&nbsp;scalar&nbsp;or&nbsp;1-D&nbsp;NumPy&nbsp;array)&nbsp;returning
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;displacement,&nbsp;velocity,&nbsp;and&nbsp;acceleration&nbsp;(each&nbsp;the&nbsp;same
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shape&nbsp;as&nbsp;t).&nbsp;&nbsp;Such&nbsp;functions&nbsp;can&nbsp;be&nbsp;defined&nbsp;within&nbsp;this
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">linear</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">linear</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ke0</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">ke0</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">pe0</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">pe0</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">lam</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">lam</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t_max</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">t_max</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">dt</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">dt</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">bcs</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">bcs</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ic_shapes</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">ic_shapes</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ic_modes</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">ic_modes</span><span style="color: rgb(23, 23, 23);">


</span><span style="color: rgb(52, 60, 247);">class</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">Solution</span><span style="color: rgb(23, 23, 23);">:

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;Collected&nbsp;results&nbsp;of&nbsp;an&nbsp;FEA&nbsp;run.
&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(50, 105, 186);">__init__</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">linear</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">linear</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ke0</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ke0</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">pe0</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">pe0</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">lam</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">lam</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t_max</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t_max</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">dt</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">dt</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u0</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">u0</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u_t0</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t0</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(50, 105, 186);">postprocess</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">M</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">Phi</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">M</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">M</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">Phi</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">Phi</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ke</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">array</span><span style="color: rgb(23, 23, 23);">([</span><span style="color: rgb(23, 23, 23);">kinetic_energy</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">[:,</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">],&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">M</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">for</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">in</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(0, 105, 138);">range</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">shape</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">])])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">pe</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">array</span><span style="color: rgb(23, 23, 23);">([</span><span style="color: rgb(23, 23, 23);">potential_energy</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">[:,</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">],&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">linear</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">for</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">in</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(0, 105, 138);">range</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">shape</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">])])

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(158, 0, 0);">#&nbsp;def&nbsp;save(self,&nbsp;overwrite=True):
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Write&nbsp;a&nbsp;solution&nbsp;to&nbsp;an&nbsp;HDF5&nbsp;file.
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5_file_name&nbsp;=&nbsp;gen_hdf5_file_name(self.name)
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;os.path.exists(hdf5_file_name):
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;overwrite:
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;emsg('File\n'&nbsp;+
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'{}\n'.format(hdf5_file_name)&nbsp;+
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'exists&nbsp;and&nbsp;overwrite&nbsp;is&nbsp;False.\n')
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit(1)
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vmsg(verbose,
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Removing&nbsp;existing&nbsp;file&nbsp;{}.\n'.format(hdf5_file_name))
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os.unlink(hdf5_file_name)
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smsg('Saving&nbsp;solution&nbsp;to&nbsp;file&nbsp;{}.\n'.format(hdf5_file_name))
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;h5py.File(hdf5_file_name,&nbsp;'w')&nbsp;as&nbsp;hdf5:
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5.attrs['name']&nbsp;=&nbsp;prob.name
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5.attrs['num_nodes']&nbsp;=&nbsp;num_nodes
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5.attrs['lam']&nbsp;=&nbsp;prob.lam
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5.attrs['ke0']&nbsp;=&nbsp;prob.ke0
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5.attrs['pe0']&nbsp;=&nbsp;prob.pe0
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5.attrs['t_max']&nbsp;=&nbsp;prob.t_max
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5.attrs['dt']&nbsp;=&nbsp;prob.dt
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5['x']&nbsp;=&nbsp;prob.x
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5['u0']&nbsp;=&nbsp;u0
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5['u_t0']&nbsp;=&nbsp;u_t0
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5['u']&nbsp;=&nbsp;u
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5['u_t']&nbsp;=&nbsp;u_t
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5['ke']&nbsp;=&nbsp;ke
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5['pe']&nbsp;=&nbsp;pe
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5['Phi']&nbsp;=&nbsp;Phi
&nbsp;&nbsp;&nbsp;&nbsp;#
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;def&nbsp;load(self):
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Read&nbsp;a&nbsp;solution&nbsp;from&nbsp;an&nbsp;HDF5&nbsp;file.
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hdf5_file_name&nbsp;=&nbsp;gen_hdf5_file_name(self.name)
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;not&nbsp;os.path.exists(hdf5_file_name):
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;emsg('File\n'&nbsp;+
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'{}\n'.format(hdf5_file_name)&nbsp;+
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'does&nbsp;not&nbsp;exist.\n')
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sys.exit(1)
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;smsg('Loading&nbsp;solution&nbsp;from&nbsp;file&nbsp;{}.\n'.format(hdf5_file_name))
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;h5py.File(hdf5_file_name,&nbsp;'r')&nbsp;as&nbsp;hdf5:
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.name&nbsp;=&nbsp;hdf5.attrs['name']
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.num_nodes&nbsp;=&nbsp;hdf5.attrs['num_nodes']
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.lam&nbsp;=&nbsp;hdf5.attrs['lam']
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ke0&nbsp;=&nbsp;hdf5.attrs['ke0']
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pe0&nbsp;=&nbsp;hdf5.attrs['pe0']
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.t_max&nbsp;&nbsp;=&nbsp;hdf5.attrs['t_max']
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.dt&nbsp;=&nbsp;hdf5.attrs['dt']
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.x&nbsp;=&nbsp;hdf5['x'][...]
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.u0&nbsp;=&nbsp;hdf5['u0'][...]
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.u_t0&nbsp;=&nbsp;hdf5['u_t0'][...]
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.u&nbsp;=&nbsp;hdf5['u'][...]
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.u_t&nbsp;=&nbsp;hdf5['u_t'][...]
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.ke&nbsp;=&nbsp;hdf5['ke'][...]
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.pe&nbsp;=&nbsp;hdf5['pe'][...]
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.Phi&nbsp;=&nbsp;hdf5['Phi'][...]
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;Reconstruct&nbsp;the&nbsp;time&nbsp;vector,&nbsp;which&nbsp;was&nbsp;not&nbsp;stored.
&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.t&nbsp;=&nbsp;np.arange(self.u.shape[1])&nbsp;*&nbsp;self.dt</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plot_mesh</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;the&nbsp;FE&nbsp;mesh.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">figure</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">patch</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_facecolor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'white'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">shape</span><span style="color: rgb(23, 23, 23);">),&nbsp;</span><span style="color: rgb(189, 17, 99);">'-bo'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlim</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">min</span><span style="color: rgb(23, 23, 23);">(),&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">max</span><span style="color: rgb(23, 23, 23);">()))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">grid</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'Mesh'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$x$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">xmargin</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(186, 103, 6);">0.1</span><span style="color: rgb(23, 23, 23);">&nbsp;*&nbsp;(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">[-</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">]&nbsp;-&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">v</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">array</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">axis</span><span style="color: rgb(23, 23, 23);">())
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">v</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">]&nbsp;=&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">]&nbsp;-&nbsp;</span><span style="color: rgb(23, 23, 23);">xmargin</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">v</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">]&nbsp;=&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">[-</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">]&nbsp;+&nbsp;</span><span style="color: rgb(23, 23, 23);">xmargin</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">axis</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">v</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">yticks</span><span style="color: rgb(23, 23, 23);">([])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">connect</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'key_press_event'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plot_ics</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;the&nbsp;initial&nbsp;conditions&nbsp;of&nbsp;the&nbsp;string.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">figure</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">patch</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_facecolor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'white'</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">subplot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(186, 103, 6);">2</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u0</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlim</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">min</span><span style="color: rgb(23, 23, 23);">(),&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">max</span><span style="color: rgb(23, 23, 23);">()))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">grid</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'Initial&nbsp;displacement'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$x$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$u_{0}$'</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">subplot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(186, 103, 6);">2</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(186, 103, 6);">2</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u_t0</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlim</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">min</span><span style="color: rgb(23, 23, 23);">(),&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">max</span><span style="color: rgb(23, 23, 23);">()))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">grid</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'Initial&nbsp;velocity'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$x$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$\dot{u}_{0}$'</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">connect</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'key_press_event'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plot_ctr_disp_vel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;displacement&nbsp;and&nbsp;velocity&nbsp;at&nbsp;the&nbsp;center&nbsp;of&nbsp;the&nbsp;string.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(0, 105, 138);">int</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(0, 105, 138);">round</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">shape</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">]/</span><span style="color: rgb(186, 103, 6);">2</span><span style="color: rgb(23, 23, 23);">))

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">figure</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">patch</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_facecolor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'white'</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">subplot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(186, 103, 6);">2</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">,&nbsp;:])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlim</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">min</span><span style="color: rgb(23, 23, 23);">(),&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">max</span><span style="color: rgb(23, 23, 23);">()))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">grid</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'String&nbsp;displacement&nbsp;at&nbsp;center'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$t$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$u$'</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">subplot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(186, 103, 6);">2</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(186, 103, 6);">2</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">,&nbsp;:])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlim</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">min</span><span style="color: rgb(23, 23, 23);">(),&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">max</span><span style="color: rgb(23, 23, 23);">()))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">grid</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'String&nbsp;velocity&nbsp;at&nbsp;center'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$t$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$u_{t}$'</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">connect</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'key_press_event'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plot_disp_snaps</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;snapshots&nbsp;of&nbsp;the&nbsp;displacement.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">num_curves</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(186, 103, 6);">21</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(158, 0, 0);">#&nbsp;T1&nbsp;=&nbsp;t[-1]</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">T1</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(186, 103, 6);">2.0</span><span style="color: rgb(23, 23, 23);">&nbsp;/&nbsp;</span><span style="color: rgb(186, 103, 6);">5.7</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">stride</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(0, 105, 138);">int</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(0, 105, 138);">round</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">T1</span><span style="color: rgb(23, 23, 23);">&nbsp;/&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">dt</span><span style="color: rgb(23, 23, 23);">&nbsp;/&nbsp;</span><span style="color: rgb(23, 23, 23);">num_curves</span><span style="color: rgb(23, 23, 23);">))

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">figure</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">patch</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_facecolor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'white'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(158, 0, 0);">#&nbsp;plt.hold(True)</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(0, 105, 138);">len</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">)&nbsp;-&nbsp;</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">for</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">in</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(0, 105, 138);">range</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">num_curves</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">[:,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">&nbsp;-=&nbsp;</span><span style="color: rgb(23, 23, 23);">stride</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlim</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">min</span><span style="color: rgb(23, 23, 23);">(),&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">max</span><span style="color: rgb(23, 23, 23);">()))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">grid</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'String&nbsp;displacement&nbsp;snapshots'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$x$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$u$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">connect</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'key_press_event'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plot_vel_snaps</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;snapshots&nbsp;of&nbsp;the&nbsp;velocity.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">num_curves</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(186, 103, 6);">21</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">T1</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">[-</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">stride</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(0, 105, 138);">int</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(0, 105, 138);">round</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">T1</span><span style="color: rgb(23, 23, 23);">&nbsp;/&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">dt</span><span style="color: rgb(23, 23, 23);">&nbsp;/&nbsp;</span><span style="color: rgb(23, 23, 23);">num_curves</span><span style="color: rgb(23, 23, 23);">))

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">figure</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">patch</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_facecolor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'white'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(158, 0, 0);">#&nbsp;plt.hold(True)</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(0, 105, 138);">len</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">)&nbsp;-&nbsp;</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">for</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">in</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(0, 105, 138);">range</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">num_curves</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">[:,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">&nbsp;-=&nbsp;</span><span style="color: rgb(23, 23, 23);">stride</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlim</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">min</span><span style="color: rgb(23, 23, 23);">(),&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">max</span><span style="color: rgb(23, 23, 23);">()))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">grid</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'String&nbsp;velocity&nbsp;snapshots'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$x$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$u_{t}$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">connect</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'key_press_event'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plot_disp_surf</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;displacement&nbsp;as&nbsp;a&nbsp;surface&nbsp;over&nbsp;(x,t).
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">X</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">meshgrid</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">figure</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">patch</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_facecolor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'white'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">add_subplot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">projection</span><span style="color: rgb(23, 23, 23);">=</span><span style="color: rgb(189, 17, 99);">'3d'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot_surface</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(50, 105, 186);">X</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">rstride</span><span style="color: rgb(23, 23, 23);">=</span><span style="color: rgb(186, 103, 6);">10</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">cstride</span><span style="color: rgb(23, 23, 23);">=</span><span style="color: rgb(186, 103, 6);">10</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">set_title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'String&nbsp;displacement'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$t$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$x$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">connect</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'key_press_event'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plot_vel_surf</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;velocity&nbsp;as&nbsp;a&nbsp;surface&nbsp;over&nbsp;(x,t).
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">X</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">meshgrid</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">figure</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">patch</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_facecolor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'white'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">add_subplot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">projection</span><span style="color: rgb(23, 23, 23);">=</span><span style="color: rgb(189, 17, 99);">'3d'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot_surface</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(50, 105, 186);">X</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">rstride</span><span style="color: rgb(23, 23, 23);">=</span><span style="color: rgb(186, 103, 6);">10</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">cstride</span><span style="color: rgb(23, 23, 23);">=</span><span style="color: rgb(186, 103, 6);">10</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">set_title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'String&nbsp;velocity'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$t$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$x$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">connect</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'key_press_event'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plot_energy_th</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;energy&nbsp;time&nbsp;histories.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">figure</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">patch</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_facecolor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'white'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(158, 0, 0);">#&nbsp;plt.hold(True)</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ke</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(189, 17, 99);">'k'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">pe</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(189, 17, 99);">'b'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ke</span><span style="color: rgb(23, 23, 23);">&nbsp;+&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">pe</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(189, 17, 99);">'r'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">legend</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(189, 17, 99);">'KE'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(189, 17, 99);">'PE'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(189, 17, 99);">'Total'</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlim</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">min</span><span style="color: rgb(23, 23, 23);">(),&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">max</span><span style="color: rgb(23, 23, 23);">()))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">grid</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'Energy'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$t$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$E$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">connect</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'key_press_event'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plot_ke_xt</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;kinetic&nbsp;energy&nbsp;density&nbsp;as&nbsp;an&nbsp;x-t&nbsp;diagram.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">skip</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">X</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">meshgrid</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(50, 105, 186);">skip</span><span style="color: rgb(23, 23, 23);">:])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">KE</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(186, 103, 6);">0.5</span><span style="color: rgb(23, 23, 23);">&nbsp;*&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">[:,</span><span style="color: rgb(50, 105, 186);">skip</span><span style="color: rgb(23, 23, 23);">:]**</span><span style="color: rgb(186, 103, 6);">2</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">figure</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">patch</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_facecolor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'white'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">pcolormesh</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">X</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">KE</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">shading</span><span style="color: rgb(23, 23, 23);">=</span><span style="color: rgb(189, 17, 99);">'auto'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(158, 0, 0);">#&nbsp;plt.colorbar()</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'String&nbsp;kinetic&nbsp;energy&nbsp;density'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$x$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$t$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">connect</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'key_press_event'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plot_ke_surf</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;kinetic&nbsp;energy&nbsp;density&nbsp;as&nbsp;a&nbsp;surface&nbsp;over&nbsp;(x,t).
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">X</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">meshgrid</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">KE</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(186, 103, 6);">0.5</span><span style="color: rgb(23, 23, 23);">&nbsp;*&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">**</span><span style="color: rgb(186, 103, 6);">2</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">figure</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">patch</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_facecolor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'white'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">add_subplot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">projection</span><span style="color: rgb(23, 23, 23);">=</span><span style="color: rgb(189, 17, 99);">'3d'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot_surface</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(50, 105, 186);">X</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">KE</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">rstride</span><span style="color: rgb(23, 23, 23);">=</span><span style="color: rgb(186, 103, 6);">10</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">cstride</span><span style="color: rgb(23, 23, 23);">=</span><span style="color: rgb(186, 103, 6);">10</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">set_title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'String&nbsp;kinetic&nbsp;energy&nbsp;density'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$t$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$x$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">connect</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'key_press_event'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plot_disp_proj</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;modal&nbsp;projections&nbsp;of&nbsp;displacement.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u_proj</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">abs</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">Phi</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">n</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">arange</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u_proj</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">shape</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">meshgrid</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">n</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">figure</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">patch</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_facecolor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'white'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">pcolormesh</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u_proj</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">shading</span><span style="color: rgb(23, 23, 23);">=</span><span style="color: rgb(189, 17, 99);">'auto'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(158, 0, 0);">#&nbsp;plt.colorbar()</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'Modal&nbsp;projections&nbsp;of&nbsp;displacement'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$t$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$n$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">connect</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'key_press_event'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plot_vel_proj</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;modal&nbsp;projections&nbsp;of&nbsp;velocity.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t_proj</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">abs</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">Phi</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">n</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">arange</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u_t_proj</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">shape</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">])
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">meshgrid</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">n</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">figure</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">patch</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_facecolor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'white'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">pcolormesh</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t_proj</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">shading</span><span style="color: rgb(23, 23, 23);">=</span><span style="color: rgb(189, 17, 99);">'auto'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(158, 0, 0);">#&nbsp;plt.colorbar()</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'Modal&nbsp;projections&nbsp;of&nbsp;velocity'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$t$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$n$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">connect</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'key_press_event'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plot_disp_asym</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;the&nbsp;asymmetry&nbsp;of&nbsp;the&nbsp;solution&nbsp;as&nbsp;a&nbsp;surface&nbsp;over&nbsp;(x,t).
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u_asymmetry</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">[:,:]&nbsp;-&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">[-</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">::-</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,:]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">X</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">meshgrid</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">figure</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">patch</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_facecolor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'white'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">add_subplot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">projection</span><span style="color: rgb(23, 23, 23);">=</span><span style="color: rgb(189, 17, 99);">'3d'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot_surface</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(50, 105, 186);">X</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u_asymmetry</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">set_title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'String&nbsp;displacement&nbsp;asymmetry'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$t$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$x$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">connect</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'key_press_event'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">plot_vel_asym</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Plot&nbsp;the&nbsp;asymmetryt&nbsp;of&nbsp;the&nbsp;velocity&nbsp;as&nbsp;a&nbsp;surface&nbsp;over&nbsp;(x,t).
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t_asymmetry</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">[:,:]&nbsp;-&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">[-</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">::-</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,:]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">X</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">meshgrid</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">self</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">figure</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">patch</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_facecolor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'white'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">fig</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">add_subplot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">projection</span><span style="color: rgb(23, 23, 23);">=</span><span style="color: rgb(189, 17, 99);">'3d'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">plot_surface</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(50, 105, 186);">X</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t_asymmetry</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">set_title</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'String&nbsp;velocity&nbsp;asymmetry'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_xlabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$t$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ax</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">set_ylabel</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'$x$'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">connect</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'key_press_event'</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">)


</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">simulate</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">verbose</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(52, 60, 247);">True</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">overwrite</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(52, 60, 247);">True</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">smsg</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'Simulation&nbsp;beginning.\n'</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">dofs</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">nodes</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">elts</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">N1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">N2</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">num_nodes</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">gen_mesh</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">M</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">C</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">global_matrices</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">elts</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">lam</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">M11</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">M12</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">M21</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">M22</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">partition_global_matrix</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">M</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">C11</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">C12</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">C21</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">C22</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">partition_global_matrix</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">C</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">K11</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">K12</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">K21</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">K22</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">partition_global_matrix</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">evals</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">evecs</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">la</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">eig</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">K11</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">M11</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">argsort</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">evals</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">evals</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">evals</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">evecs</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">evecs</span><span style="color: rgb(23, 23, 23);">[:,</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">omega</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">sqrt</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">real</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">evals</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">Phi</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(23, 23, 23);">N1</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">for</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">in</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(0, 105, 138);">range</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(0, 105, 138);">len</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">evals</span><span style="color: rgb(23, 23, 23);">)):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">Phi</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">]&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">evecs</span><span style="color: rgb(23, 23, 23);">[:,</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">Phi</span><span style="color: rgb(23, 23, 23);">[:,</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">]&nbsp;/=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">sqrt</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">Phi</span><span style="color: rgb(23, 23, 23);">[:,</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">].</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">M</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">Phi</span><span style="color: rgb(23, 23, 23);">[:,</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">])))
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">if</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(50, 105, 186);">verbose</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 105, 138);">print</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'Lowest&nbsp;frequencies&nbsp;of&nbsp;linear&nbsp;string:'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(0, 105, 138);">print</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">omega</span><span style="color: rgb(23, 23, 23);">[:</span><span style="color: rgb(186, 103, 6);">5</span><span style="color: rgb(23, 23, 23);">])

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t0</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ic_shapes</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">if</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(0, 105, 138);">len</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ic_modes</span><span style="color: rgb(23, 23, 23);">)&nbsp;&gt;&nbsp;</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">vmsg</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">verbose</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(189, 17, 99);">'Projecting&nbsp;initial&nbsp;conditions&nbsp;onto&nbsp;selected&nbsp;modes.\n'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">Phi_hat</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">Phi</span><span style="color: rgb(23, 23, 23);">[:,</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ic_modes</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u0</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">Phi_hat</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">Phi_hat</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u0</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t0</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">Phi_hat</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">Phi_hat</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u_t0</span><span style="color: rgb(23, 23, 23);">))

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">vmsg</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">verbose</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(189, 17, 99);">'Scaling&nbsp;initial&nbsp;conditions.\n'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">if</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">pe0</span><span style="color: rgb(23, 23, 23);">&nbsp;&gt;&nbsp;</span><span style="color: rgb(186, 103, 6);">0.0</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u0</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">u0</span><span style="color: rgb(23, 23, 23);">&nbsp;*&nbsp;(</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">pe0</span><span style="color: rgb(23, 23, 23);">&nbsp;/&nbsp;</span><span style="color: rgb(23, 23, 23);">potential_energy</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">linear</span><span style="color: rgb(23, 23, 23);">))**(</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">/</span><span style="color: rgb(186, 103, 6);">4</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">else</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u0</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u0</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">shape</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">if</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ke0</span><span style="color: rgb(23, 23, 23);">&nbsp;&gt;&nbsp;</span><span style="color: rgb(186, 103, 6);">0.0</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t0</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t0</span><span style="color: rgb(23, 23, 23);">&nbsp;*&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">sqrt</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ke0</span><span style="color: rgb(23, 23, 23);">&nbsp;/&nbsp;</span><span style="color: rgb(23, 23, 23);">kinetic_energy</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u_t0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">M</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">else</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t0</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u_t0</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">shape</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">vmsg</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">verbose</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(189, 17, 99);">'Starting&nbsp;time&nbsp;integration.\n'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">arange</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(186, 103, 6);">0.0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">t_max</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">dt</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">y0</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(186, 103, 6);">2</span><span style="color: rgb(23, 23, 23);">*</span><span style="color: rgb(23, 23, 23);">N1</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">y0</span><span style="color: rgb(23, 23, 23);">[:</span><span style="color: rgb(23, 23, 23);">N1</span><span style="color: rgb(23, 23, 23);">]&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">u0</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">y0</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">N1</span><span style="color: rgb(23, 23, 23);">:]&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t0</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">M11LU</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">la</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">lu_factor</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">M11</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">eom</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">y</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">y1</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">y</span><span style="color: rgb(23, 23, 23);">[:</span><span style="color: rgb(23, 23, 23);">N1</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">y2</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">y</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">N1</span><span style="color: rgb(23, 23, 23);">:]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u2</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u2_t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u2_tt</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">boundary_conditions</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">dofs</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">if</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">linear</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">alpha</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(186, 103, 6);">1.0</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">else</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">]&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">y1</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">]&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">u2</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">alpha</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">yt</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">y</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">shape</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">yt</span><span style="color: rgb(23, 23, 23);">[:</span><span style="color: rgb(23, 23, 23);">N1</span><span style="color: rgb(23, 23, 23);">]&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">y2</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">yt</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">N1</span><span style="color: rgb(23, 23, 23);">:]&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">la</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">lu_solve</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">M11LU</span><span style="color: rgb(23, 23, 23);">,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;</span><span style="color: rgb(23, 23, 23);">C11</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">y2</span><span style="color: rgb(23, 23, 23);">)&nbsp;-&nbsp;</span><span style="color: rgb(23, 23, 23);">alpha</span><span style="color: rgb(23, 23, 23);">&nbsp;*&nbsp;</span><span style="color: rgb(23, 23, 23);">K11</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">y1</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;</span><span style="color: rgb(23, 23, 23);">M12</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u2_tt</span><span style="color: rgb(23, 23, 23);">)&nbsp;-&nbsp;</span><span style="color: rgb(23, 23, 23);">C12</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u2_t</span><span style="color: rgb(23, 23, 23);">)&nbsp;-&nbsp;</span><span style="color: rgb(23, 23, 23);">alpha</span><span style="color: rgb(23, 23, 23);">&nbsp;*&nbsp;</span><span style="color: rgb(23, 23, 23);">K12</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u2</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">return</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">yt</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">y</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">scipy</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">integrate</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">odeint</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">eom</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">y0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">vmsg</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">verbose</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(189, 17, 99);">'Extracting&nbsp;u&nbsp;and&nbsp;u_t&nbsp;from&nbsp;y&nbsp;and&nbsp;inserting&nbsp;BCs.\n'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u2</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u2_t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u2_tt</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">boundary_conditions</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">dofs</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(0, 105, 138);">len</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">)))
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(0, 105, 138);">len</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">)))
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">,:]&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">y</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">[:</span><span style="color: rgb(23, 23, 23);">N1</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">,:]&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">y</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">T</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">N1</span><span style="color: rgb(23, 23, 23);">:]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">,:]&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">u2</span><span style="color: rgb(23, 23, 23);">[...]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">,:]&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">u2_t</span><span style="color: rgb(23, 23, 23);">[...]

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">vmsg</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">verbose</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(189, 17, 99);">'Creating&nbsp;Solution&nbsp;instance&nbsp;from&nbsp;time&nbsp;histories.\n'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">soln</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">Solution</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">smsg</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'Simulation&nbsp;completed.\n'</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">smsg</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'Postprocessing.\n'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">soln</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">postprocess</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">M</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">Phi</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">smsg</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'Postprocessing&nbsp;completed.\n'</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">return</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">soln</span><span style="color: rgb(23, 23, 23);">


</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">gen_hdf5_file_name</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">name</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">hdf5_file_name</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(189, 17, 99);">'{}.hdf5'</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">format</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">name</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">return</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">hdf5_file_name</span><span style="color: rgb(23, 23, 23);">


</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">gen_mesh</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;nodes,&nbsp;DOF,&nbsp;and&nbsp;elements.

&nbsp;&nbsp;&nbsp;&nbsp;Arguments
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prob&nbsp;&nbsp;Problem&nbsp;instance

&nbsp;&nbsp;&nbsp;&nbsp;Returns
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dofs&nbsp;&nbsp;&nbsp;List&nbsp;of&nbsp;DOF&nbsp;instances
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nodes&nbsp;&nbsp;List&nbsp;of&nbsp;Node&nbsp;instances
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elts&nbsp;&nbsp;&nbsp;List&nbsp;of&nbsp;Element&nbsp;instances
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number&nbsp;of&nbsp;degrees&nbsp;of&nbsp;freedom&nbsp;(total)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number&nbsp;of&nbsp;unconstrained&nbsp;degrees&nbsp;of&nbsp;freedom
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Number&nbsp;of&nbsp;constrained&nbsp;degrees&nbsp;of&nbsp;freedom&nbsp;(BCs)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idx1&nbsp;&nbsp;&nbsp;Scalar&nbsp;eq&nbsp;numbers&nbsp;(constrained)&nbsp;(1-D&nbsp;NumPy&nbsp;arrary)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idx2&nbsp;&nbsp;&nbsp;Scalar&nbsp;eq&nbsp;numbers&nbsp;(unconstrained)&nbsp;(1-D&nbsp;NumPy&nbsp;arrary)
&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">num_nodes</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(0, 105, 138);">len</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">num_dofs</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">num_nodes</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">num_elts</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">num_nodes</span><span style="color: rgb(23, 23, 23);">&nbsp;-&nbsp;</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">dofs</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;[]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">for</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">in</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(0, 105, 138);">range</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">num_dofs</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">dofs</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">append</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">DOF</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(52, 60, 247);">None</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">for</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">bc</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">in</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">bcs</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">dofs</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">].</span><span style="color: rgb(23, 23, 23);">bc</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">bc</span><span style="color: rgb(23, 23, 23);">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">nodes</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;[]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">for</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">in</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(0, 105, 138);">range</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">num_nodes</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">nodes</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">append</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">Node</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">prob</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">x</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">],&nbsp;</span><span style="color: rgb(23, 23, 23);">dofs</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">]))

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">elts</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;[]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">for</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">in</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(0, 105, 138);">range</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">num_elts</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">elts</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">append</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">Element</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">,&nbsp;[</span><span style="color: rgb(23, 23, 23);">nodes</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">],&nbsp;</span><span style="color: rgb(23, 23, 23);">nodes</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">+</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">]]))

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;[]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;[]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">for</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">in</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">dofs</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">if</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">bc</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">is</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">None</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">append</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">number</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">else</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">append</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">number</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">array</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">array</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(0, 105, 138);">len</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">dofs</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">N1</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(0, 105, 138);">len</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">N2</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(0, 105, 138);">len</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">)

&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">return</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">dofs</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">nodes</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">elts</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">N1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">N2</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">num_nodes</span><span style="color: rgb(23, 23, 23);">


</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">global_matrices</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">elts</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">lam</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;global&nbsp;mass,&nbsp;damping,&nbsp;and&nbsp;linear&nbsp;stiffness&nbsp;matrices.

&nbsp;&nbsp;&nbsp;&nbsp;Arguments
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total&nbsp;number&nbsp;of&nbsp;degrees&nbsp;of&nbsp;freedom
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;elts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;List&nbsp;of&nbsp;Element&nbsp;instances
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lam&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Distributed&nbsp;damping&nbsp;coefficient&nbsp;(scalar)

&nbsp;&nbsp;&nbsp;&nbsp;Returns
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&nbsp;&nbsp;Global&nbsp;mass&nbsp;matrix&nbsp;(N&nbsp;x&nbsp;N&nbsp;NumPy&nbsp;array)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C&nbsp;&nbsp;Global&nbsp;damping&nbsp;matrix&nbsp;(N&nbsp;x&nbsp;N&nbsp;NumPy&nbsp;array)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K&nbsp;&nbsp;Global&nbsp;linear&nbsp;stiffness&nbsp;matrix&nbsp;(N&nbsp;x&nbsp;N&nbsp;NumPy&nbsp;array)
&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">M</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">C</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(23, 23, 23);">N</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">for</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">elt</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">in</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">elts</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">add_to_global_matrix</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">M</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">elt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">mass_matrix</span><span style="color: rgb(23, 23, 23);">(),&nbsp;</span><span style="color: rgb(23, 23, 23);">elt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">add_to_global_matrix</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">C</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">elt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">damping_matrix</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">lam</span><span style="color: rgb(23, 23, 23);">),&nbsp;</span><span style="color: rgb(23, 23, 23);">elt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">add_to_global_matrix</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">elt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">stiffness_matrix</span><span style="color: rgb(23, 23, 23);">(),&nbsp;</span><span style="color: rgb(23, 23, 23);">elt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">return</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">M</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">C</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">


</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">add_to_global_matrix</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">A</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">a</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;Add&nbsp;contributions&nbsp;of&nbsp;element&nbsp;matrix&nbsp;a&nbsp;to&nbsp;global&nbsp;matrix&nbsp;A.

&nbsp;&nbsp;&nbsp;&nbsp;Arguments
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;Global&nbsp;matrix&nbsp;(N&nbsp;x&nbsp;N&nbsp;NumPy&nbsp;array)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;&nbsp;&nbsp;&nbsp;Element&nbsp;matrix&nbsp;(2&nbsp;x&nbsp;2&nbsp;NumPy&nbsp;array)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dof&nbsp;&nbsp;List&nbsp;of&nbsp;2&nbsp;DOF&nbsp;instances
&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">n0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">n1</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;[</span><span style="color: rgb(23, 23, 23);">dof</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">].</span><span style="color: rgb(50, 105, 186);">number</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">for</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">in</span><span style="color: rgb(23, 23, 23);">&nbsp;(</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">)]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">A</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">n0</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(23, 23, 23);">n0</span><span style="color: rgb(23, 23, 23);">]&nbsp;+=&nbsp;</span><span style="color: rgb(23, 23, 23);">a</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">A</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">n0</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(23, 23, 23);">n1</span><span style="color: rgb(23, 23, 23);">]&nbsp;+=&nbsp;</span><span style="color: rgb(23, 23, 23);">a</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">A</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">n1</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(23, 23, 23);">n0</span><span style="color: rgb(23, 23, 23);">]&nbsp;+=&nbsp;</span><span style="color: rgb(23, 23, 23);">a</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">A</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">n1</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(23, 23, 23);">n1</span><span style="color: rgb(23, 23, 23);">]&nbsp;+=&nbsp;</span><span style="color: rgb(23, 23, 23);">a</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">,</span><span style="color: rgb(186, 103, 6);">1</span><span style="color: rgb(23, 23, 23);">]


</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">partition_global_matrix</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">A</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;partitions&nbsp;of&nbsp;global&nbsp;matrix&nbsp;A.

&nbsp;&nbsp;&nbsp;&nbsp;Arguments
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Global&nbsp;matrix&nbsp;(N&nbsp;x&nbsp;N&nbsp;NumPy&nbsp;array)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idx1&nbsp;&nbsp;Indices&nbsp;of&nbsp;unconstrained&nbsp;scalar&nbsp;eqs&nbsp;(1-D&nbsp;NumPy&nbsp;array)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idx2&nbsp;&nbsp;Indices&nbsp;of&nbsp;constrained&nbsp;scalar&nbsp;eqs&nbsp;(1-D&nbsp;NumPy&nbsp;array)

&nbsp;&nbsp;&nbsp;&nbsp;Returns
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A11&nbsp;&nbsp;Partition&nbsp;of&nbsp;A&nbsp;indexed&nbsp;by&nbsp;(idx1,&nbsp;idx1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A12&nbsp;&nbsp;Partition&nbsp;of&nbsp;A&nbsp;indexed&nbsp;by&nbsp;(idx1,&nbsp;idx2)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A21&nbsp;&nbsp;Partition&nbsp;of&nbsp;A&nbsp;indexed&nbsp;by&nbsp;(idx2,&nbsp;idx1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A22&nbsp;&nbsp;Partition&nbsp;of&nbsp;A&nbsp;indexed&nbsp;by&nbsp;(idx2,&nbsp;idx2)
&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">A11</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">A</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">,:][:,</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">A12</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">A</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">,:][:,</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">A21</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">A</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">,:][:,</span><span style="color: rgb(23, 23, 23);">idx1</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">A22</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">A</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">,:][:,</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">]
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">return</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">A11</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">A12</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">A21</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">A22</span><span style="color: rgb(23, 23, 23);">


</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">boundary_conditions</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">dofs</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;the&nbsp;values&nbsp;of&nbsp;the&nbsp;geometric&nbsp;boundary&nbsp;conditions.

&nbsp;&nbsp;&nbsp;&nbsp;Arguments
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dofs&nbsp;&nbsp;List&nbsp;of&nbsp;DOF&nbsp;instances&nbsp;where&nbsp;BCs&nbsp;are&nbsp;applied
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;idx2&nbsp;&nbsp;Indices&nbsp;of&nbsp;constrained&nbsp;scalar&nbsp;eqs&nbsp;(1-D&nbsp;NumPy&nbsp;array)

&nbsp;&nbsp;&nbsp;&nbsp;Returns
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Boundary&nbsp;displacements
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u2_t&nbsp;&nbsp;&nbsp;Boundary&nbsp;velocities
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u2_tt&nbsp;&nbsp;Boundary&nbsp;accelerations

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;t&nbsp;is&nbsp;a&nbsp;vector&nbsp;(1-D&nbsp;NumPy&nbsp;array),&nbsp;each&nbsp;of&nbsp;these&nbsp;is&nbsp;a&nbsp;1-D
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NumPy&nbsp;array&nbsp;of&nbsp;size&nbsp;N2&nbsp;x&nbsp;len(t).&nbsp;If&nbsp;t&nbsp;is&nbsp;a&nbsp;scalar,&nbsp;each&nbsp;of
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;these&nbsp;is&nbsp;a&nbsp;1-D&nbsp;NumPy&nbsp;array&nbsp;of&nbsp;length&nbsp;N2.
&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">if</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">isscalar</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u2</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(0, 105, 138);">len</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">else</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u2</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">((</span><span style="color: rgb(0, 105, 138);">len</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">),&nbsp;</span><span style="color: rgb(0, 105, 138);">len</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">)))
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u2_t</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u2</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">shape</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u2_tt</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u2</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">shape</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">for</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(52, 60, 247);">in</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(0, 105, 138);">enumerate</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">idx2</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">if</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(0, 105, 138);">callable</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">dofs</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">].</span><span style="color: rgb(23, 23, 23);">bc</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">g</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">g_t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">g_tt</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">dofs</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">].</span><span style="color: rgb(23, 23, 23);">bc</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">else</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">g</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">dofs</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">idx</span><span style="color: rgb(23, 23, 23);">].</span><span style="color: rgb(23, 23, 23);">bc</span><span style="color: rgb(23, 23, 23);">&nbsp;*&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">ones</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">size</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">g_t</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">shape</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">g_tt</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">zeros</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">np</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">shape</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">t</span><span style="color: rgb(23, 23, 23);">))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u2</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">]&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">g</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u2_t</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">]&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">g_t</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">u2_tt</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(23, 23, 23);">i</span><span style="color: rgb(23, 23, 23);">]&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">g_tt</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">return</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">u2</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u2_t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">u2_tt</span><span style="color: rgb(23, 23, 23);">


</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">kinetic_energy</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">M</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;the&nbsp;kinetic&nbsp;energy&nbsp;of&nbsp;the&nbsp;continuum.

&nbsp;&nbsp;&nbsp;&nbsp;Arguments
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u_t&nbsp;&nbsp;Velocity&nbsp;vector&nbsp;(1-D&nbsp;NumPy&nbsp;array)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&nbsp;&nbsp;&nbsp;&nbsp;Global&nbsp;mass&nbsp;matrix&nbsp;(2-D&nbsp;NumPy&nbsp;array)

&nbsp;&nbsp;&nbsp;&nbsp;Returns
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ke&nbsp;&nbsp;Kinetic&nbsp;energy&nbsp;(scalar)
&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">ke</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">M</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">u_t</span><span style="color: rgb(23, 23, 23);">))&nbsp;/&nbsp;</span><span style="color: rgb(186, 103, 6);">2.0</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">return</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">ke</span><span style="color: rgb(23, 23, 23);">


</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">potential_energy</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">linear</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""
&nbsp;&nbsp;&nbsp;&nbsp;Return&nbsp;the&nbsp;potential&nbsp;energy&nbsp;of&nbsp;the&nbsp;continuum.

&nbsp;&nbsp;&nbsp;&nbsp;Arguments
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Displacement&nbsp;vector&nbsp;(1-D&nbsp;NumPy&nbsp;array)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;K&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Global&nbsp;linear&nbsp;stiffness&nbsp;matrix
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linear&nbsp;&nbsp;Problem&nbsp;type&nbsp;(Boolean)

&nbsp;&nbsp;&nbsp;&nbsp;Returns
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pe&nbsp;&nbsp;Potential&nbsp;energy&nbsp;(scalar)
&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">if</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">linear</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">pe</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">))&nbsp;/&nbsp;</span><span style="color: rgb(186, 103, 6);">2.0</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">else</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">pe</span><span style="color: rgb(23, 23, 23);">&nbsp;=&nbsp;</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">K</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">dot</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">u</span><span style="color: rgb(23, 23, 23);">))**</span><span style="color: rgb(186, 103, 6);">2</span><span style="color: rgb(23, 23, 23);">&nbsp;/&nbsp;</span><span style="color: rgb(186, 103, 6);">4.0</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">return</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">pe</span><span style="color: rgb(23, 23, 23);">


</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">key_press_event</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">event</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""Interpret&nbsp;a&nbsp;single&nbsp;keypress&nbsp;in&nbsp;a&nbsp;plot&nbsp;window."""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">if</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">event</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">key</span><span style="color: rgb(23, 23, 23);">&nbsp;==&nbsp;</span><span style="color: rgb(189, 17, 99);">'c'</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">close</span><span style="color: rgb(23, 23, 23);">()
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">elif</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">event</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">key</span><span style="color: rgb(23, 23, 23);">&nbsp;==&nbsp;</span><span style="color: rgb(189, 17, 99);">'q'</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">plt</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">close</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'all'</span><span style="color: rgb(23, 23, 23);">)


</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">emsg</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">s</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""Display&nbsp;an&nbsp;error&nbsp;message."""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">sys</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">stderr</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">write</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(189, 17, 99);">'{}:&nbsp;{}\n'</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(0, 105, 138);">format</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">sys</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">argv</span><span style="color: rgb(23, 23, 23);">[</span><span style="color: rgb(186, 103, 6);">0</span><span style="color: rgb(23, 23, 23);">],&nbsp;</span><span style="color: rgb(23, 23, 23);">s</span><span style="color: rgb(23, 23, 23);">))

</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">smsg</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">s</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""Display&nbsp;a&nbsp;status&nbsp;message."""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">vmsg</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(52, 60, 247);">True</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">s</span><span style="color: rgb(23, 23, 23);">)

</span><span style="color: rgb(52, 60, 247);">def</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(23, 23, 23);">vmsg</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(50, 105, 186);">verbose</span><span style="color: rgb(23, 23, 23);">,&nbsp;</span><span style="color: rgb(23, 23, 23);">s</span><span style="color: rgb(23, 23, 23);">):
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(201, 56, 126);">"""Display&nbsp;a&nbsp;status&nbsp;message&nbsp;if&nbsp;being&nbsp;verbose."""</span><span style="color: rgb(23, 23, 23);">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(52, 60, 247);">if</span><span style="color: rgb(23, 23, 23);">&nbsp;</span><span style="color: rgb(50, 105, 186);">verbose</span><span style="color: rgb(23, 23, 23);">:
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: rgb(23, 23, 23);">sys</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(23, 23, 23);">stdout</span><span style="color: rgb(23, 23, 23);">.</span><span style="color: rgb(50, 105, 186);">write</span><span style="color: rgb(23, 23, 23);">(</span><span style="color: rgb(23, 23, 23);">s</span><span style="color: rgb(23, 23, 23);">)
</span></code></pre></body>
</html>
